## Syntax

### Kommentare

Kommentare werden in R wie in Bash, Python oder Perl mit einer Raute
eingeleitet.

```{r comments}

# Dies ist ein Kommentar.

##################################################
# Dies ist ein Kommentar
# über mehrere Zeilen.
##################################################

print("Hallo Welt!") # Der Kommentar kann auch dahinter stehen.

```

### Instruktionen

Instruktionen werden wie in C mittels Semicolon getrennt.

```{r}
x <- "Hallo Welt!"; print(x);
```

Am Zeilenende können diese ausgelassen werden.

```{r}
x <- "Hallo Welt!"
print(x)
```

### Blöcke und Einrückungen

Programmcode wird in Bereiche eingeteilt, die gezielt ausführbar sind. Ein
solcher Bereich wird Block genannt und besteht aus mehreren Zeilen von
Instruktionen. Beispiele solcher Blöcke sind Funktionen, Schleifen oder die
unterschiedlichen Zweige von If-Else-Bedingungen. Daraus ergibt sich, dass die
Blöcke verschachtelt auftreten, wenn z.B. eine Funktion eine Schleife enthält.

```{r blocks}
# Ein Funktionsblock, der einen Schleifenblock enthält.
show <- function() {
    for(i in 1:3) {
        print(i);
    }
}
show()
```

Wie werden solche Blöcke nun definiert?

Drei Techniken sind bei Programmiersprachen verbreitet, erstens Schlüsselworte
(Keywords), zweitens Einrückungstiefen (Indentation, Off-Side-Rule), drittens
geschweifte Klammern. Keywords wurden bereits in den 1950er von ALGOL benutzt.
Heute findest Du sie z.B. in Ruby und Bash. Off-Side-Rule wird u.a. verwendet
von Python, YAML und CoffeScript und lässt sich bis ins Jahr 1966 zurück
verfolgen. Die geschweiften Klammern wurden 1972 mit C eingeführt und haben
heute eine weite Verbreitung so in C++, Java, C#, JavaScript, Perl oder Go.

R verwendet geschweifte Klammern wie C. Gerade mit einer deutschen Tastatur
sind diese Klammern lästig zu tippen und einrückem muss man den Code für die
Lesbarkeit genau so wie bei der Off-Side-Rule. Es ist vor allem mehr Arbeit. Im
Vergleich zur Off-Side-Rule sieht ein solcher Text viel technischer und damit
schlechter lesbar aus.


```{r blocks2}
# Einrückungen dienen in R nur der Lesbarkeit. Das funktioniert genau so.
show <- function() { for(i in 1:3) { print(i); } }; show();
```

Warum verwendet R geschweifte Klammern und warum sind
sie so weit verbreitet?

Sicherlich hat C einen grossen normativen Einfluss ausgeübt, gerade in der Zeit
als die Sprache entworfen wurde. Geschweifte Klammern sind im Vergleich zum
Whitespace von Einrückungen leichter zu parsen. Fehler sind seltener. Gerade
in grossen Projekten sind Fehler, die durch Einrückungsfehler entstehen,
schwierig zu finden. Werden Sprachen gemischt wird es mit Einrückungen
besonders schwierig.

Fazit: Unterm Strich ist es etwas bedauerlich, dass R nicht wie Python Off-Side-Rule verwendet. Zu lang sind die Skripte eigentlich nicht.

#### Blöcke sind Instruktionen

### Variablen

Variablennamen folgen grundsätzlich den Mustern verbreiteter Sprachen.

* Namen bestehen aus Buchstaben, Ziffern, Unterstrichen oder Punkten.
* Namen starten mit einem Buchstaben oder mit einem Punkt.
* Nach einem anführenden Punkt darf keine Ziffer folgen (falsch: .2x).
* Reservierte Worte dürfen nicht verwendet werden.

Reservierte Worte sind kein Ding. Du erkennst das automatisch an der
Fehlermeldung.

Das überraschende ist der Punkt als gültiger Bestandteil von Variablennamen. In
anderen Sprachen werden damit Elemente eines Objektes angesprochen. Das
geschieht in R mittels des Dollarzeichens.

```{r}
a <- list("alpha" = 1, "beta" = 2) # Variable a befüllt mit einer Liste.
a.dot <- "Punkt" # Eine unabhängige Variable, die nur aussieht wie Teil von a.
print(a) # Die Liste a enthält nicht "Punkt" und wurde auch nicht überschrieben.
print(a.dot) # "Punkt" wird unabhängig ausgegeben.
print(a$beta) # Mit dem $-Zeichen wird ein Element von a angesprochen.
print(a$dot) # Dieses gibt es dagegen nicht.
```

**Tip**: Wenn Du Verwirrungen mit anderen Sprachen minimieren willst,
verwendest Du den Punkt als Worttrenner nicht. Er ist eher eine Erblast als ein
Feature oder besonders R-stylisch. Die besseren Alternativen sind
*unter_strich* oder *CamelCase*.

### Zuweisungen

Kurz gesagt, die Zuweisung zu Variablen erfolgt in R mittels des
Zuweisungsoperators `<-`  während die Zuweisung zu Funktionsparametern und zu
Namen in Listen und Data-Frames mit dem Gleichheitszeichen `=` erfolgt.

Dieses Beispiel zeigt die Anwendung von `<-` und `=`.

```{r assignments}
##################################################
# Create a dataframe with calculated planet data.
#
# @param names Characters of names.
# @param radii Numbers of radii in km.
# @return data.frame
##
setupPlanets <- function(names, radii, star = "Sonne") {
     data.frame(
        Name = names,
        Star = star,
        Radius = radii,
        Diameter = 2 * radii,
        Perimeter = 2 * pi * radii,
        Surface = 4 * pi * radii^2,
        Volume =  4/3 * pi * radii^3
    )
 }

input <- list(
    names = c("Merkur", "Venus", "Erde", "Mars"),
    radii = c(2440, 6052, 6371, 3389)
)
planets <- setupPlanets(radii = input$radii, names = input$names)
print(planets)
```

Hier definiere ich eine Funktion und weise sie der Variablen `setupPlanets`
mittels des `<-`-Operators zu.  Das speichern ganzer Funktionen in Variablen
charakterisiert eine funktionale Programmiersprache. Eine solche Zuweisung
erfolgt auch bei den Variablen `input` und `planets`, denen eine Liste bzw.
einen Data-Frame zugewiesen wird.

Sowohl beim Data-Frame als auch bei der Liste werden die einzelnen benannten
Elemente mittels `=` zugewiesen.

Das Gleichheitszeichen verwende ich auch, um den Parameter `star` bei der
Funktionsdefinition mit einem Default-Wert vorzubelegen, hier `"Sonne"`.
Beim Funktionsaufruf dient mir das Gleichheitszeichen schließlich dazu, die
Parameter mit ihrem Namen statt mit ihrer Reihenfolge an zu sprechen.  Hier
habe ich die Reihenfolge vertauscht, um das zu demonstrieren.

#### Diskussion der Alternativen

Es ist oft, aber eben nicht immer, technisch möglich Variablen mittels `=`
statt mittels `<-` zuzuweisen. Weil das ein Zeichen weniger zu tippen ist und
den Zuweisungen in vielen anderen Programmiersprachen entspricht, wird Dir das
im Code vieler Leute begegnen. Um einen klaren, einheitlichen Programmierstil
zu pflegen, solltest Du aber konsequent `<-` für die Zuweisung von Variablen
benutzen. Das ist einfach R-stylisch.

Die Zuweisung mittels `<--` ist möglich, aber für die Zuweisung an
übergeordnete Sichtbarkeitsbereiche gedacht. Du musst wissen, was du hiermit
tust. Dazu mehr im Kapitel über die Sichtbarkeitsbereiche.

`->` macht genau dasselbe wie `<-`. Nicht dass Du denkst die Variable käme dann
nach rechts. Es ist also nicht intuitiv verständlich.

Analog ist `-->` dasselbe `<--` und nicht intuitiv verständlich.

Also:

* `=` Ist nicht überall einsetzbar und nicht R-stylisch.
* `->` Ist verwirrend.
* `<--` Du solltest wissen, was Du tust.
* `-->` Ist verwirrent und Du solltest wissen, was Du tust.

**Tip**: Variablenzuweisung mittels `<-` bevorzugen.

### Namensräume

Variablen können bereits Funktionen oder Daten enthalten, auch die aus
den Basis-Paketen und die aus den Bibliotheken, die Du lädst.

Du musst also
aufpassen, dass Du keine Namen von Funktionen oder Daten überschreibst,
jedenfalls nicht solche, die Du später noch verwenden willst.

Tust Du es doch, dann kannst du die Variablen der Pakte aber immer noch über
ihren Full Qualified Name ansprechen. Das kann einerseits lohnenswert sein, um
einen sprechenden Variablennamen wie "data" frei einsetzen zu können,
andererseits  kann es auch eingefleischte R-Benutzer verwirren, wenn der
vertraute Name "zweckentfremdet" wird.

```{r}
# Die Funktion print ist im Paket base
base::print("Hallo")
# Das Paket base ist per default geladen.
# Darum kann base::print() verkürzt angesprochen werden.
print("Hallo")
# Die Variable print wird hier mit einer Funktion definiert.
print <- function(...) { "Nope" }
# Was passiert jetzt?
print("Welt")
# Der Fully Qualified Name funktioniert weiterhin.
base::print("Welt")
# Definition aufheben.
remove(print)
# Jetzt wird wieder base::print() angesprochen.
print("Welt")
```

### Coding Guidelines

